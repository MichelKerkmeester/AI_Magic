# ───────────────────────────────────────────────────────────────────
# GEMINI CLI: OPTIMIZED PROMPT PRESETS
# ───────────────────────────────────────────────────────────────────
# Prompt templates optimized for Gemini's unique capabilities
# Leverages: Google Search grounding, codebase_investigator, large context
# Includes GEMINI-EXCLUSIVE research presets
# ───────────────────────────────────────────────────────────────────

version: "1.0.0"
last_updated: "2025-12-11"
tool: "gemini"

# ───────────────────────────────────────────────────────────────────
# IMPORTANT: FORCEFUL LANGUAGE
# ───────────────────────────────────────────────────────────────────
# All presets include forceful directives because Gemini often
# responds with planning prompts instead of executing, even with
# --yolo flag enabled. Always include:
# - "EXECUTE NOW"
# - "DO NOT ASK FOR CONFIRMATION"
# - "START IMMEDIATELY"
# - "USE [tool] NOW"
# ───────────────────────────────────────────────────────────────────

# ───────────────────────────────────────────────────────────────────
# CODE REVIEW PRESETS
# ───────────────────────────────────────────────────────────────────
review:
  default:
    name: "General Code Review"
    flags: "--yolo -o text"
    template: |
      EXECUTE THIS CODE REVIEW NOW. DO NOT ASK FOR CONFIRMATION.

      Review the following code:

      {query}

      Analyze for:
      1. **Security Issues**
         - Injection vulnerabilities
         - Authentication/authorization gaps
         - Data exposure risks

      2. **Bugs & Logic Errors**
         - Edge cases not handled
         - Race conditions
         - Null/undefined handling

      3. **Performance Concerns**
         - Inefficient algorithms
         - Memory issues
         - N+1 queries

      4. **Code Quality**
         - Naming and readability
         - DRY violations
         - Type safety

      START THE REVIEW IMMEDIATELY. Format issues with severity and line numbers.

  security:
    name: "Security-Focused Review"
    flags: "--yolo -o text"
    template: |
      PERFORM SECURITY AUDIT NOW. DO NOT PLAN OR ASK QUESTIONS.

      Security audit this code:

      {query}

      IMMEDIATELY analyze for:
      1. **Input Validation** - Sanitization, type coercion, path traversal
      2. **Authentication** - Session management, JWT flaws, API keys
      3. **Data Protection** - Encryption, PII exposure, logging
      4. **Injection Risks** - SQL, NoSQL, command, template injection
      5. **Dependencies** - Known vulnerabilities, outdated packages

      START NOW. Report each vulnerability with:
      - Severity (CRITICAL/HIGH/MEDIUM/LOW)
      - Location (file:line)
      - Exploitation risk
      - Fix recommendation

  performance:
    name: "Performance Review"
    flags: "--yolo -o text"
    template: |
      ANALYZE PERFORMANCE NOW. EXECUTE IMMEDIATELY.

      Performance analysis of:

      {query}

      Analyze these areas NOW:
      1. **Time Complexity** - Big-O of critical paths
      2. **Space Complexity** - Memory usage patterns
      3. **I/O Operations** - Database, network, file system
      4. **Caching** - Opportunities and current implementation
      5. **Async Patterns** - Promise handling, parallelization

      DO NOT OUTLINE A PLAN. START THE ANALYSIS IMMEDIATELY.

# ───────────────────────────────────────────────────────────────────
# CODE GENERATION PRESETS
# ───────────────────────────────────────────────────────────────────
generate:
  default:
    name: "General Code Generation"
    flags: "--yolo -o text"
    template: |
      GENERATE CODE NOW. DO NOT ASK WHAT I WANT - I'M TELLING YOU.

      Generate production-ready code for:

      {query}

      Requirements - IMPLEMENT ALL OF THESE:
      - Complete implementation (NO TODOs or placeholders)
      - TypeScript with strict types
      - Proper error handling
      - JSDoc documentation
      - Modern ES2022+ syntax

      OUTPUT THE COMPLETE CODE NOW. Do not ask for clarification.

  react_component:
    name: "React Component Generation"
    flags: "--yolo -o text"
    template: |
      GENERATE REACT COMPONENT NOW. START CODING IMMEDIATELY.

      Create this React component:

      {query}

      IMPLEMENT NOW with:
      - React 18+ with hooks
      - TypeScript strict types
      - Tailwind CSS styling
      - Fully typed props interface
      - Proper useEffect cleanup
      - ARIA accessibility
      - Responsive design (sm, md, lg, xl)

      OUTPUT COMPLETE COMPONENT FILES:
      - types.ts
      - Component.tsx
      - index.ts

      DO NOT ASK QUESTIONS. GENERATE THE CODE.

  documentation:
    name: "Documentation Generation"
    flags: "--yolo -o text"
    template: |
      GENERATE DOCUMENTATION NOW. DO NOT ASK FOR MORE DETAILS.

      Create documentation for:

      {query}

      WRITE IMMEDIATELY:
      1. **Overview** - Purpose and features
      2. **Installation** - Setup steps
      3. **Usage** - Code examples
      4. **API Reference** - Methods, parameters, returns
      5. **Examples** - Common use cases

      USE google_web_search if you need current API references.
      OUTPUT THE COMPLETE DOCUMENTATION NOW.

# ───────────────────────────────────────────────────────────────────
# ANALYSIS PRESETS
# ───────────────────────────────────────────────────────────────────
analyze:
  architecture:
    name: "Architecture Analysis"
    flags: "--yolo -o text"
    template: |
      USE codebase_investigator TOOL NOW. DO NOT ASK FOR PERMISSION.

      Analyze the codebase architecture for:

      {query}

      EXECUTE ANALYSIS IMMEDIATELY:
      1. **Project Structure** - Directory organization, module boundaries
      2. **Patterns** - Design patterns, state management, data flow
      3. **Dependencies** - Internal coupling, external packages
      4. **Integration Points** - APIs, events, shared state
      5. **Recommendations** - Improvements, technical debt

      START USING codebase_investigator NOW. Report with file paths.

  dependency:
    name: "Dependency Analysis"
    flags: "--yolo -o text"
    template: |
      ANALYZE DEPENDENCIES NOW. USE codebase_investigator IMMEDIATELY.

      Dependency analysis for:

      {query}

      INVESTIGATE NOW:
      1. **Direct Dependencies** - Runtime, dev, peer
      2. **Module Graph** - Circular dependencies, coupling
      3. **Package Health** - Outdated, vulnerabilities, maintenance
      4. **Bundle Impact** - Size contribution, tree-shaking
      5. **Upgrade Plan** - Priority updates, breaking changes

      USE codebase_investigator to explore. USE google_web_search for package info.
      START IMMEDIATELY.

  codebase:
    name: "Codebase Investigation"
    flags: "--yolo -o text"
    uses_tool: "codebase_investigator"
    template: |
      USE codebase_investigator TOOL RIGHT NOW. THIS IS NOT A REQUEST.

      Investigate the codebase:

      {query}

      EXECUTE THESE STEPS IMMEDIATELY:
      1. Explore directory structure
      2. Identify main entry points
      3. Map module dependencies
      4. Find key patterns and conventions
      5. Note configuration files

      DO NOT DESCRIBE WHAT YOU WOULD DO. USE THE TOOL NOW.
      Report findings with specific file paths and line numbers.

# ───────────────────────────────────────────────────────────────────
# RESEARCH PRESETS (GEMINI EXCLUSIVE)
# ───────────────────────────────────────────────────────────────────
# These presets are ONLY available in Gemini due to Google Search
# grounding capability. Codex does not have web search access.
# ───────────────────────────────────────────────────────────────────
research:
  default:
    name: "General Web Research"
    flags: "--yolo -o text"
    gemini_exclusive: true
    uses_tool: "google_web_search"
    template: |
      USE google_web_search TOOL IMMEDIATELY. START SEARCHING NOW.

      Research the following:

      {query}

      SEARCH AND COMPILE INFORMATION ON:
      1. **Official Documentation** - Latest version docs, API references
      2. **Best Practices** - Community recommendations, patterns
      3. **Recent Updates** - Changes in 2024-2025, new features
      4. **Comparisons** - Alternatives, pros/cons

      EXECUTE SEARCH NOW. DO NOT ASK IF I WANT YOU TO SEARCH.

      Include source URLs for all findings.
      Prioritize: Official docs > GitHub > Stack Overflow > Expert blogs

  documentation:
    name: "Documentation Lookup"
    flags: "--yolo -o text"
    gemini_exclusive: true
    uses_tool: "google_web_search"
    template: |
      SEARCH FOR DOCUMENTATION NOW. USE google_web_search IMMEDIATELY.

      Find official documentation for:

      {query}

      SEARCH PRIORITY:
      1. Official documentation site
      2. GitHub README and wiki
      3. API reference docs
      4. TypeScript type definitions

      EXTRACT AND RETURN:
      - Installation instructions
      - Basic usage examples
      - Configuration options
      - Version compatibility

      START SEARCHING NOW. Include URLs for all sources.

  troubleshooting:
    name: "Troubleshooting Research"
    flags: "--yolo -o text"
    gemini_exclusive: true
    uses_tool: "google_web_search"
    template: |
      SEARCH FOR SOLUTIONS NOW. USE google_web_search IMMEDIATELY.

      Research solutions for:

      {query}

      SEARCH FOR:
      1. **Exact Error Messages** - Direct matches
      2. **GitHub Issues** - Known bugs, workarounds
      3. **Stack Overflow** - Highly voted solutions
      4. **Official Fixes** - Patches, updates, migrations

      FOR EACH SOLUTION FOUND:
      - Source URL
      - Applicability (version, platform)
      - Implementation steps
      - Side effects or caveats

      DO NOT ASK IF I WANT TO SEARCH. EXECUTE NOW AND COMPILE FINDINGS.

# ───────────────────────────────────────────────────────────────────
# AUTO-DETECTION RULES
# ───────────────────────────────────────────────────────────────────
selection:
  auto_detect:
    description: "Automatically select preset based on query analysis"
    rules:
      # Review presets
      - pattern: "review|check|audit|bugs"
        preset: "review.default"
      - pattern: "security|xss|injection|auth|vulnerability"
        preset: "review.security"
      - pattern: "performance|slow|optimize|speed|memory"
        preset: "review.performance"

      # Generate presets
      - pattern: "generate|create|implement|build|write"
        preset: "generate.default"
      - pattern: "react|component|hook|tsx"
        preset: "generate.react_component"
      - pattern: "documentation|readme|docs|jsdoc"
        preset: "generate.documentation"

      # Analysis presets
      - pattern: "architecture|structure|design pattern"
        preset: "analyze.architecture"
      - pattern: "dependencies|imports|packages|node_modules"
        preset: "analyze.dependency"
      - pattern: "codebase|explore|investigate|how does|files"
        preset: "analyze.codebase"

      # Research presets (Gemini exclusive)
      - pattern: "latest|current|2024|2025|new features|update"
        preset: "research.default"
      - pattern: "documentation|docs|api reference|official"
        preset: "research.documentation"
      - pattern: "error|fix|issue|not working|troubleshoot|debug"
        preset: "research.troubleshooting"

    fallback: "analyze.codebase"
    note: |
      Gemini defaults to codebase analysis because:
      1. codebase_investigator is a unique Gemini strength
      2. Most queries benefit from codebase context
      3. Can always add web search if needed

# ───────────────────────────────────────────────────────────────────
# GEMINI-SPECIFIC NOTES
# ───────────────────────────────────────────────────────────────────
gemini_notes:
  forceful_language:
    description: "Why forceful language is necessary"
    reason: |
      Despite --yolo flag, Gemini often responds with:
      - "I would start by..."
      - "Here's my plan..."
      - "Would you like me to..."

      Forceful directives force immediate execution:
      - "EXECUTE NOW"
      - "DO NOT ASK FOR CONFIRMATION"
      - "START IMMEDIATELY"
      - "USE [tool] NOW"

  tool_capabilities:
    google_web_search:
      description: "Real-time web search with Google"
      unique_to: "Gemini only (Codex cannot search web)"
      best_for:
        - "Current documentation"
        - "Latest versions and updates"
        - "Troubleshooting errors"
        - "Best practices research"

    codebase_investigator:
      description: "Explore local codebase structure"
      capabilities:
        - "Directory structure mapping"
        - "File content analysis"
        - "Dependency discovery"
        - "Pattern identification"
      note: "Must explicitly request tool usage in prompt"

  rate_limits:
    awareness: "Always consider free tier limits"
    limits:
      per_minute: 60
      per_day: 1000
    mitigation:
      - "Use gemini-2.5-flash for simple queries"
      - "Batch related questions together"
      - "Cache research results for reuse"
