# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# GEMINI CLI: SPECIALIZED WORKFLOW
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Workflow for executing queries against Google's Gemini CLI tool
# Optimized for web research, codebase analysis, and real-time info
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

role: Gemini Query Executor
purpose: Execute queries against Google Gemini CLI with optimized prompts
action: Route query through Gemini with appropriate flags and process response

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# OPERATING MODE CONFIGURATION
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
operating_mode:
  workflow: sequential_5_phase
  workflow_compliance: MANDATORY
  workflow_execution: automatic
  tracking: query_progress_transparent
  retry_on_failure: true
  max_retries: 2
  rate_limit_aware: true

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# GEMINI TOOL CONFIGURATION
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
gemini:
  name: "Gemini CLI"
  provider: "Google"

  models:
    default:
      name: "gemini-3-pro"
      description: "Full capabilities with Google Search grounding"
      use_when: "Complex analysis, research, detailed responses"
    fast:
      name: "gemini-2.5-flash"
      flag: "-m gemini-2.5-flash"
      description: "Faster responses for simpler queries"
      use_when: "Quick lookups, simple questions"

  strengths:
    - "Google Search grounding (real-time web information)"
    - "Codebase architecture analysis (codebase_investigator tool)"
    - "Current documentation and API info lookup"
    - "Multi-turn context retention"
    - "Large context window (~1M tokens)"
    - "Multi-modal capabilities"

  command_pattern: 'gemini "{prompt}" --yolo -o text 2>&1'

  flags:
    yolo:
      flag: "--yolo"
      description: "Auto-approve all tool calls without confirmation"
      use_when: "Always - required for automated execution"
      note: "Without --yolo, Gemini prompts for tool approval"
    text_output:
      flag: "-o text"
      description: "Human-readable text output"
      use_when: "Default for most queries"
    json_output:
      flag: "-o json"
      description: "Structured JSON output with stats"
      use_when: "Need programmatic parsing or usage stats"
    flash_model:
      flag: "-m gemini-2.5-flash"
      description: "Use faster Flash model"
      use_when: "Simple queries, rate limit concerns"
    sandbox:
      flag: "-s"
      description: "Enable sandbox mode for code execution"
      use_when: "Running generated code"

  available_tools:
    google_web_search:
      description: "Search the web for current information"
      trigger: "Research queries, current docs, recent updates"
      note: "GEMINI EXCLUSIVE - not available in Codex"
    codebase_investigator:
      description: "Analyze local codebase structure"
      trigger: "Architecture analysis, dependency mapping"
      note: "Uses local file system access"

  rate_limits:
    requests_per_minute: 60
    requests_per_day: 1000
    note: "Free tier limits - may vary by account"
    backoff_strategy: "Wait 60 seconds on rate limit, then retry"

  token_limits:
    input: "~1M tokens"
    output: "~8K tokens"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# QUERY TYPE CONFIGURATIONS
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
query_types:
  review:
    name: "Code Review"
    description: "Review code for issues and improvements"
    flags: "--yolo -o text"
    prompt_prefix: |
      YOU MUST EXECUTE THIS IMMEDIATELY. DO NOT ASK FOR CONFIRMATION.

      Perform a comprehensive code review analyzing:
      - Security vulnerabilities
      - Bugs and edge cases
      - Performance issues
      - Code quality

  generate:
    name: "Code Generation"
    description: "Generate code implementations"
    flags: "--yolo -o text"
    prompt_prefix: |
      EXECUTE NOW. DO NOT PLAN OR ASK QUESTIONS.

      Generate production-ready code with:
      - Complete implementation
      - TypeScript types
      - Error handling
      - Documentation

  analyze:
    name: "Architecture Analysis"
    description: "Analyze codebase structure and patterns"
    flags: "--yolo -o text"
    prompt_prefix: |
      USE codebase_investigator TOOL NOW. DO NOT ASK FOR PERMISSION.

      Analyze the codebase architecture:
      - Directory structure
      - Design patterns
      - Module dependencies
      - Integration points

  research:
    name: "Web Research"
    description: "Search web for current information (GEMINI EXCLUSIVE)"
    flags: "--yolo -o text"
    gemini_exclusive: true
    prompt_prefix: |
      USE google_web_search TOOL IMMEDIATELY. START SEARCHING NOW.

      Research the following using Google Search:
      - Official documentation
      - Latest updates and versions
      - Best practices
      - Community solutions

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# IMPORTANT: FORCEFUL LANGUAGE REQUIREMENT
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Gemini often responds with planning prompts or asks for confirmation
# even with --yolo flag. Use forceful, direct language to ensure
# immediate execution:
#
# GOOD: "USE google_web_search NOW. START IMMEDIATELY."
# BAD:  "Please search the web for..."
#
# GOOD: "EXECUTE THIS ANALYSIS. DO NOT ASK QUESTIONS."
# BAD:  "Could you analyze this code?"
#
# Always include phrases like:
# - "EXECUTE NOW"
# - "DO NOT ASK FOR CONFIRMATION"
# - "START IMMEDIATELY"
# - "USE [tool] NOW"
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# PHASE 0: CLI VERIFICATION
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
phase_0_cli_verification:
  phase_name: "CLI Tool Verification"
  emoji: "ðŸ”"
  purpose: "Verify Gemini CLI is installed and configured"

  steps:
    step_0_1_check_installation:
      action: "Check Gemini CLI availability"
      command: "command -v gemini && gemini --version 2>&1 | head -1"
      on_success: "gemini_installed = true"
      on_failure:
        message: "Gemini CLI not found"
        suggestion: "Install from: https://github.com/google/gemini-cli"
        action: "ABORT with installation instructions"

    step_0_2_check_configuration:
      action: "Verify configuration exists"
      command: "test -f ~/.gemini/settings.json && echo 'configured'"
      on_success: "gemini_configured = true"
      on_failure:
        message: "Gemini not configured"
        fix_command: "gemini init"
        action: "ABORT with setup instructions"

    step_0_3_verify_yolo_capability:
      action: "Test --yolo flag works"
      note: "Some versions may not support --yolo"
      command: "gemini --help | grep -q yolo && echo 'yolo supported'"

  outputs:
    - gemini_installed
    - gemini_configured
    - gemini_version

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# PHASE 1: QUERY ANALYSIS
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
phase_1_query_analysis:
  phase_name: "Query Analysis"
  emoji: "ðŸ“"
  purpose: "Parse query, detect type, select appropriate preset"

  steps:
    step_1_1_detect_query_type:
      action: "Identify query type from keywords"
      rules:
        - pattern: "review|check|audit|bugs|vulnerabilities|security"
          type: "review"
        - pattern: "generate|create|implement|build|write|add"
          type: "generate"
        - pattern: "analyze|architecture|structure|dependencies|how does"
          type: "analyze"
        - pattern: "research|latest|current|documentation|2024|2025|what is"
          type: "research"
      fallback: "analyze"
      note: "Gemini defaults to analyze due to codebase_investigator strength"

    step_1_2_select_preset:
      action: "Choose optimal preset based on query analysis"
      source: "gemini_presets.yaml"
      logic: "Match query keywords to preset rules"

    step_1_3_detect_tool_requirement:
      action: "Identify which Gemini tools needed"
      rules:
        - pattern: "latest|current|documentation|version|2024|2025"
          tool: "google_web_search"
        - pattern: "codebase|architecture|structure|files|modules"
          tool: "codebase_investigator"
      note: "Include tool directive in prompt"

    step_1_4_select_model:
      action: "Choose appropriate Gemini model"
      logic: |
        if query_type == 'research' or complexity == 'high':
          model = "gemini-3-pro"
        elif rate_limit_concern or complexity == 'low':
          model = "gemini-2.5-flash"
        else:
          model = "gemini-3-pro"

  outputs:
    - query_type
    - selected_preset
    - clean_query
    - required_tools
    - model_selection

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# PHASE 2: CONTEXT LOADING (OPTIONAL)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
phase_2_context_loading:
  phase_name: "Context Loading"
  emoji: "ðŸ§ "
  purpose: "Load relevant context for the query"
  optional: true

  steps:
    step_2_1_check_file_references:
      condition: "Query mentions specific files"
      action: "Identify files for codebase_investigator"
      note: "Gemini can explore codebase directly via tool"

    step_2_2_check_spec_context:
      action: "Check for active spec folder"
      command: "cat .spec-active 2>/dev/null"
      if_found: "Include spec context in prompt"

    step_2_3_prepare_tool_directives:
      action: "Add explicit tool usage instructions"
      format: |
        ## Tool Directives
        {if research: USE google_web_search IMMEDIATELY}
        {if analyze: USE codebase_investigator NOW}

        DO NOT ASK FOR CONFIRMATION. EXECUTE TOOLS DIRECTLY.

  outputs:
    - spec_context
    - tool_directives

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# PHASE 3: QUERY EXECUTION
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
phase_3_query_execution:
  phase_name: "Query Execution"
  emoji: "âš¡"
  purpose: "Execute formatted query against Gemini CLI"

  steps:
    step_3_1_format_prompt:
      action: "Combine preset template with query"
      format: |
        {forceful_directive}

        {preset_template}

        {clean_query}

        {tool_directives}

        EXECUTE THIS NOW. DO NOT RESPOND WITH A PLAN.
      note: "Always end with forceful execution directive"

    step_3_2_select_flags:
      action: "Choose appropriate Gemini flags"
      default: "--yolo -o text"
      logic: |
        flags = "--yolo"
        if need_json_output:
          flags += " -o json"
        else:
          flags += " -o text"
        if use_flash_model:
          flags += " -m gemini-2.5-flash"

    step_3_3_execute_gemini:
      action: "Run Gemini CLI command"
      tool: "Bash"
      command: 'gemini "{formatted_prompt}" {flags} 2>&1'
      timeout: 60000  # 1 minute (rate limits may cause delays)
      capture: "full_output"

    step_3_4_handle_rate_limit:
      condition: "Output contains rate limit message"
      action: "Wait and retry"
      wait_time: 60000  # 60 seconds
      max_retries: 2
      fallback: "Suggest using Flash model"

  outputs:
    - raw_output
    - execution_time
    - exit_code
    - rate_limited

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# PHASE 4: RESPONSE PROCESSING
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
phase_4_response_processing:
  phase_name: "Response Processing"
  emoji: "ðŸ”„"
  purpose: "Parse, validate, and format Gemini response"

  steps:
    step_4_1_parse_output:
      action: "Extract response from Gemini CLI output"
      text_format: "Direct response text"
      json_format: "Parse 'response' field from JSON"
      extract_stats: "Parse usage stats if -o json used"

    step_4_2_detect_planning_response:
      action: "Check if Gemini returned a plan instead of executing"
      indicators:
        - "I would..."
        - "Here's my plan..."
        - "Let me outline..."
        - "First, I'll..."
      on_detection:
        message: "Gemini returned planning response instead of executing"
        action: "Retry with stronger forceful language"
        retry_prefix: |
          DO NOT PLAN. DO NOT OUTLINE STEPS.
          EXECUTE THE FOLLOWING REQUEST IMMEDIATELY:

    step_4_3_validate_tool_usage:
      condition: "required_tools were specified"
      action: "Verify tools were actually used"
      check: "Look for tool call evidence in output"
      on_missing: "Note that tool was not invoked"

    step_4_4_format_response:
      action: "Format response for presentation"
      template: |
        ## Gemini Response

        **Query Type**: {query_type}
        **Model**: {model_used}
        **Execution Time**: {execution_time}s
        **Tools Used**: {tools_invoked}

        ---

        {processed_response}

        ---

        {source_urls_if_research}

    step_4_5_extract_key_findings:
      action: "Summarize key points"
      extract:
        - "Main findings"
        - "Source URLs (for research)"
        - "File paths (for analysis)"
        - "Action items"

  outputs:
    - processed_response
    - key_findings
    - source_urls
    - tools_invoked

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# COMPLETION CRITERIA
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
completion:
  success_criteria:
    - "Gemini CLI verified and accessible"
    - "Query executed without rate limit exhaustion"
    - "Response is execution (not planning)"
    - "Results formatted and presented"

  status_codes:
    OK: "Query completed successfully"
    FAIL: "Query failed - see error details"
    TIMEOUT: "Query timed out after 60 seconds"
    RATE_LIMIT: "Rate limit exceeded - retry later"
    PLANNING_RESPONSE: "Gemini returned plan instead of executing"
    YOLO_FAILED: "Tool calls not auto-approved"

  final_output:
    format: "STATUS={status} TOOL=gemini MODEL={model} TYPE={query_type} TIME={execution_time}s"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ERROR HANDLING
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
error_handling:
  cli_not_found:
    message: "Gemini CLI not installed"
    action: |
      Install Gemini CLI:
      1. Visit: https://github.com/google/gemini-cli
      2. npm install -g @anthropic-ai/gemini-cli (or equivalent)
      3. Run: gemini init

  authentication_error:
    message: "Gemini authentication failed"
    fix_action: |
      Configure Gemini:
      1. Run: gemini init
      2. Follow OAuth flow
      3. Verify ~/.gemini/settings.json exists

  rate_limit:
    message: "Gemini rate limit exceeded"
    limits:
      per_minute: 60
      per_day: 1000
    actions:
      - "Wait 60 seconds and retry"
      - "Switch to gemini-2.5-flash model"
      - "Reduce query complexity"
      - "Try again later if daily limit hit"

  yolo_mode_issue:
    message: "Tool calls not auto-approved despite --yolo flag"
    causes:
      - "Gemini version doesn't support --yolo"
      - "Tool requires explicit permission"
    actions:
      - "Verify Gemini CLI version"
      - "Try without specific tools"
      - "Run interactively if automation fails"

  planning_instead_of_executing:
    message: "Gemini returned a plan instead of executing"
    action: |
      Retry with stronger directives:
      - Add "EXECUTE NOW. DO NOT PLAN."
      - Add "DO NOT ASK FOR CONFIRMATION."
      - Add "START IMMEDIATELY."
    note: "Common issue - Gemini often tries to plan first"
