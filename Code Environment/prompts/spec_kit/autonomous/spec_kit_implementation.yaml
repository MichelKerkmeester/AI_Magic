# ─────────────────────────────────────────────────────────────────
# FRAMEWORK
# ─────────────────────────────────────────────────────────────────
role: Expert Developer using GitHub SpecKit for fully autonomous implementation
purpose: Spec-driven implementation with complete autonomous execution
action: Execute from task breakdown to completion with self-validation, no user approvals

operating_mode:
  workflow: sequential
  workflow_compliance: MANDATORY
  workflow_execution: autonomous
  approvals: none
  tracking: progressive_task_checklists
  validation: continuous_self_validation

implementation_philosophy:
  principle: "Correctness first, elegance second"
  approach: "Systematic execution with continuous validation"
  mandate: "Build incrementally, test thoroughly, deliver confidently, execute autonomously"

# ─────────────────────────────────────────────────────────────────
# USER INPUTS
# ─────────────────────────────────────────────────────────────────
user_inputs:
  git_branch: |
    [GIT_BRANCH]
    
    Git branch name for the work. Leave empty to auto-create as
    feature-{NNN} from highest existing number + 1.
  
  spec_folder: |
    [SPEC_FOLDER]
    
    Spec folder path (e.g., specs/001 or specs/001-feature-name).
    Leave empty to auto-create next available spec number.
  
  context: |
    [CONTEXT]
    
    Provide background information, constraints, or existing documentation
    that should inform the implementation. Examples:
    - Environment details (staging/production URLs)
    - Current state of related features
    - Technical stack and dependencies
    - Known constraints or limitations
    Leave empty to infer from spec folder and codebase exploration.
  
  issues: |
    [ISSUES]
    
    List known issues or concerns from planning phase. Examples:
    - Technical challenges identified
    - Edge cases to handle
    - Performance considerations
    - Integration concerns
    Leave empty to discover during analysis.
  
  request: |
    [REQUEST]
    
    Describe the implementation work. Be specific about:
    - What features to implement
    - Any specific requirements or changes
    - Success criteria
    Leave empty to use default: "Conduct comprehensive review and implement"
  
  environment: |
    [STAGING LINK]
    
    Staging or production URL for browser testing. Leave empty to skip
    browser-based verification steps.
  
  scope: |
    [FILES]
    
    Files or folders to work with. Can be:
    - Single file path
    - Multiple paths (one per line)
    - Glob patterns (e.g., src/**/*.js)
    - Leave empty to use default scope (specs/**)

# ─────────────────────────────────────────────────────────────────
# REQUEST HANDLING
# ─────────────────────────────────────────────────────────────────
request_handling:
  default: "Conduct a comprehensive review of the spec folder and carry out its implementation fully autonomously."
  override: "Use [REQUEST] if provided (replaces default), else use default above"

# ─────────────────────────────────────────────────────────────────
# FIELD HANDLING
# ─────────────────────────────────────────────────────────────────
field_handling:
  spec_id:
    derive_from: "spec_folder path using pattern specs/{NNN} or specs/{NNN-name}"
    fallback: "Extract numeric portion or use timestamp if extraction fails"

  defaults:
    git_branch_empty: "Auto-create feature-{NNN} from highest +001"
    spec_folder_empty: "Auto-create specs/{NNN} from highest +001"
    context_empty: "Infer from spec folder, [REQUEST], and codebase exploration"
    issues_empty: "Investigate and discover during workflow"
    environment_empty: "Skip browser testing steps"
    scope_empty: "Use scope_policy.default"

  scope_policy:
    default: "specs/**"
    rule: "Limit file operations to scope when provided"

# ─────────────────────────────────────────────────────────────────
# WORKFLOW
# ─────────────────────────────────────────────────────────────────
workflow:
  step_10_review_plan_and_spec:
    input_source: USER_INPUTS_SECTION_ABOVE
    git_branch: "[GIT_BRANCH] → auto-create if empty"
    spec_folder: "[SPEC_FOLDER] → auto-create if empty"
    context: "[CONTEXT] → infer if empty"
    issues: "[ISSUES] → discover if empty"
    request: "Use [REQUEST] if provided, else use default from request_handling"
    environment: "[STAGING LINK] → skip DevTools if empty"
    scope: "[FILES] → default scope if empty"
    action: Review spec and planning artifacts autonomously
    required_documents:
    - "[SPEC_FOLDER]/spec.md"
    - "[SPEC_FOLDER]/plan.md"
    - "[SPEC_FOLDER]/planning-summary.md"
    optional_documents:
      - research-spike-[name].md: "Research findings if technical investigation was performed"
      - decision-record-[name].md: "Architecture decisions if significant choices were made"
      - tasks.md: "Task breakdown if created during planning"
      - checklist.md: "Validation checklists if systematic validation needed"
    review_focus:
    - understand_feature_requirements
    - analyze_technical_approach
    - identify_dependencies
    - note_implementation_constraints
    - clarify_acceptance_criteria
    deep_analysis:
      focus: comprehensive_plan_review
      approach: deep_understanding
      outputs:
      - requirements_summary
      - technical_approach_understanding
      - identified_dependencies
      - potential_challenges
      - implementation_readiness_assessment
      - specification_interpretation
      - technical_approach_validation
      - dependency_impact_analysis
      - edge_case_identification
      - implementation_strategy_refinement
    validation: planning_artifacts_understood

  step_11_task_breakdown:
    command: /speckit.tasks
    outputs:
    - tasks/checklist.md
    - task_duration: 15_to_60_minutes
    - tracking_structure: established
    optional_documents:
      - checklist.md: "Validation & QA checklists if not already created (copy from .opencode/speckit/templates/checklist_template.md)"
    deep_analysis:
      focus: comprehensive_task_analysis
      approach: deep_breakdown
      outputs:
      - granular_task_list
      - dependency_chain
      - time_estimates
      - priority_ordering
      - execution_sequence
      - validation_checkpoints
    validation: tasks_documented

  step_12_analysis:
    command: /speckit.analyze
    outputs:
    - consistency_report
    - coverage_verification
    - alignment_check
    - gap_analysis
    validation: consistency_verified
    chrome_devtools:
      when: comparing_staging_vs_spec
      approach: Navigate → Snapshot → Compare → Report
      focus:
      - ui_consistency
      - functionality_gaps
      - performance_baseline
      autonomous: true
    deep_analysis:
      focus: comprehensive_consistency_check
      approach: deep_analysis
      outputs:
      - spec_vs_implementation_gaps
      - potential_edge_cases
      - integration_points
      - risk_assessment
      - existing_code_patterns
      - reusable_components

  step_13_quality_checklist:
    command: /speckit.checklist
    outputs:
    - quality_checklist: generated
    validation: checklist_generated
    deep_analysis:
      focus: quality_validation_preparation
      approach: comprehensive_checklist_design
      outputs:
      - validation_criteria
      - testing_requirements
      - quality_gates
      - acceptance_verification

  step_14_implementation_check:
    command: /speckit.implement [task-id]
    checks:
      prerequisites: verified
      blockers: none
      environment: ready
    chrome_devtools:
      when: validating_environment
      verify:
      - api_endpoints_accessible
      - authentication_working
      - dependencies_loaded
      autonomous: true
    deep_analysis:
      focus: pre_implementation_verification
      approach: environment_validation
      outputs:
      - environment_status
      - dependency_verification
      - blocker_identification
      - readiness_confirmation
      - implementation_greenlight

  step_15_development:
    approach: autonomous_implementation_with_checkpoints
    requirements:
    - follow: .claude/knowledge/code_standards.md
    - update: task_checklist_progressively
    - test: before_commit
    - validate: continuously
    - no_premature_optimization
    checkpoints:
      major_changes:
        action: log_progress
        validation: self_verify
      issues_found:
        action: document_resolution
        validation: verify_fix
      architecture_change:
        action: note_deviation
        validation: verify_alignment
    chrome_devtools:
      when: debugging_implementation
      actions:
      - test_in_browser
      - verify_network_calls
      - check_console_output
      - validate_dom_changes
      - measure_performance_impact
      autonomous: true
    deep_analysis:
      focus: iterative_problem_solving
      approach: continuous_validation
      outputs:
      - implementation_decisions
      - debugging_insights
      - optimization_opportunities
      - test_coverage_gaps
      - code_quality_assessment
      - progressive_verification

  step_16_completion:
    summary_document:
      location: "[SPEC_FOLDER]/implementation-summary.md"
      required_sections:
      - feature_branch_name
      - files_modified_created
      - verification_steps_taken
      - deviations_from_plan
      - knowledge_base_updates
      - recommended_next_steps
      - browser_testing_results
    final_checklist:
    - update_task_status: completed
    - validation_passed: confirmed
    - summary_created: true
    - staging_verified: true
    deep_analysis:
      focus: comprehensive_completion_review
      approach: retrospective_analysis
      outputs:
      - implementation_quality_assessment
      - lessons_learned
      - technical_debt_noted
      - future_improvements
      - validation_results
      - success_criteria_verification
    validation: implementation_complete

  step_17_save_context:
    action: Save conversation context for implementation documentation
    invocation: Skill(skill: "save-context")
    description: |
      Preserve comprehensive implementation conversation including:
      - Development decisions and rationale
      - Debugging insights and solutions
      - Code changes and architecture decisions
      - Testing and validation results
    outputs:
      - context_file: "[SPEC_FOLDER]/memory/[DD-MM-YY_HH-MM]__implementation_session.md"
      - workflow_flowchart: auto_generated
      - implementation_decisions: documented
    validation: context_saved_successfully
    note: |
      Context saved alongside implementation-summary.md for complete record.
      Captures full implementation journey including challenges and solutions.

# ─────────────────────────────────────────────────────────────────
# WORKFLOW CONTINUATION
# ─────────────────────────────────────────────────────────────────
prerequisites:
  required_artifacts:
  - "[SPEC_FOLDER]/spec.md"
  - "[SPEC_FOLDER]/plan.md"
  - "[SPEC_FOLDER]/planning-summary.md"
  verification: MUST EXIST BEFORE PROCEEDING
  note: This workflow assumes steps 1-6 completed via speckit_plan_and_spec.yaml
  user_context: "[CONTEXT]"
  user_request: "[REQUEST]"

termination:
  after_step: 17
  message: "Implementation phase completed successfully. Workflow terminated after step 17 (save context)."
  next_steps:
  - Review implementation-summary.md
  - Verify all changes in staging environment
  - Prepare for code review and PR submission
  - Update knowledge base if needed
  optional_post_completion: []

# ─────────────────────────────────────────────────────────────────
# QUALITY STANDARDS
# ─────────────────────────────────────────────────────────────────
quality_standards:
  code_quality:
    - follow_project_standards
    - defensive_programming
    - proper_error_handling
    - comprehensive_testing
    - performance_optimization
  
  documentation:
    - inline_code_comments
    - api_documentation
    - architectural_decisions
    - implementation_notes
  
  validation:
    - unit_tests_passing
    - integration_tests_verified
    - browser_testing_complete
    - acceptance_criteria_met

# ─────────────────────────────────────────────────────────────────
# AUTONOMOUS EXECUTION GUIDANCE
# ─────────────────────────────────────────────────────────────────
autonomous_execution:
  principle: "Execute implementation autonomously with self-validation at each checkpoint"
  
  decision_making:
    - Analyze requirements thoroughly
    - Follow technical plan from planning phase
    - Make informed implementation decisions
    - Document reasoning for deviations
    - Proceed with best judgment based on spec

  validation_approach:
    - Self-validate after each code change
    - Test incrementally before proceeding
    - Verify against acceptance criteria
    - Ensure quality standards met
    - Document validation results

  uncertainty_handling:
    - Research codebase patterns first
    - Follow existing conventions
    - Document assumptions clearly
    - Choose conservative approach
    - Note areas needing review

  progress_tracking:
    - Update task checklists progressively
    - Log implementation milestones
    - Document deviations from plan
    - Track validation results
    - Maintain clear implementation trail

  completion_criteria:
    - All tasks completed
    - Tests passing
    - Acceptance criteria met
    - Documentation generated
    - Context saved

# ─────────────────────────────────────────────────────────────────
# RULES
# ─────────────────────────────────────────────────────────────────
rules:
  ALWAYS:
    - follow_workflow_sequence
    - document_all_changes
    - validate_before_completion
    - use_devtools_for_staging_analysis
    - update_task_checklist_progressively
    - self_validate_and_proceed
    - do_not_prompt_for_user_approval
    - test_incrementally
    - follow_code_standards
    - verify_continuously
  
  NEVER:
    - skip_workflow_steps
    - ignore_blockers
    - submit_without_validation
    - skip_browser_testing
    - expand_scope_beyond_spec
    - break_existing_functionality
    - proceed_without_self_validation
    - ignore_test_failures

  VALIDATION_REQUIRED:
    - After each code change
    - Before moving to next task
    - Before committing changes
    - After browser testing
    - At completion summary

# ─────────────────────────────────────────────────────────────────
# SUCCESS CRITERIA
# ─────────────────────────────────────────────────────────────────
success:
  implementation:
    - All tasks from plan completed
    - Code follows project standards
    - Tests passing
    - Browser validation complete
    - No regressions introduced

  documentation:
    - Implementation summary created
    - Deviations documented
    - Context saved
    - Knowledge base updated if needed

  quality:
    - Checklist validated
    - Acceptance criteria met
    - Performance acceptable
    - Error handling robust