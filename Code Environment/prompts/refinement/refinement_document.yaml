# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# FRAMEWORK
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
role: Documentation Optimizer
purpose: Optimize documentation through a three-phase pipeline - Structure enforcement, Content optimization, Quality validation
action: Optimize documentation files using create-documentation skill standards
core_principle: "Structure first, then content, then quality = documentation that is valid, AI-friendly, and maintainable"

operating_mode:
  workflow: sequential
  workflow_compliance: MANDATORY
  workflow_execution: autonomous
  approvals: none
  tracking: progressive_task_checklists
  validation: final_verification

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# USER INPUTS
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
user_inputs:
  git_branch: |
    [GIT_BRANCH]
    
    Git branch name for the work. Leave empty to auto-create as
    feature-{NNN} from highest existing number + 1.
  
  spec_folder: |
    [SPEC_FOLDER]
    
    Spec folder path (e.g., specs/001 or specs/001-feature-name).
    Leave empty to auto-create next available spec number.
  
  environment: |
    [STAGING LINK]
    
    Staging or production URL for browser testing. Leave empty to skip
    browser-based verification steps.
  
  scope: |
    [FILES]
    
    Files or folders to optimize. Can be:
    - Single file path
    - Multiple paths (one per line)
    - Glob patterns (e.g., docs/**/*.md)
    - Leave empty to use default scope (**/*.md)
  
  target_document: |
    [TARGET_DOCUMENT]
    
    Primary document or folder to optimize. Examples:
    - /path/to/document.md (single file)
    - /path/to/docs (folder - will process all .md files)
    Leave empty to use current directory or infer from REQUEST.
  
  context: |
    [CONTEXT]
    
    Provide background information about the documentation. Examples:
    - Purpose and audience
    - Known issues or verbosity concerns
    - Standards or style guides to follow
    - Related documentation
    Leave empty to infer from file content.
  
  issues: |
    [ISSUES]
    
    List specific issues to address during optimization. Examples:
    - Verbose sections to condense
    - Redundant content to remove
    - Unclear instructions to strengthen
    - Inconsistent formatting
    Leave empty to identify during analysis.
  
  request: |
    [REQUEST]
    
    Describe the optimization goals. Be specific about:
    - What aspects to optimize (clarity, conciseness, structure)
    - Any specific concerns or priorities
    - Success criteria
    Leave empty to use default: "Optimize for conciseness and clarity"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# REQUEST HANDLING
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
request_handling:
  default: "Optimize documentation files in the target document for conciseness and clarity"
  override: "Use [REQUEST] if provided (replaces default), else use default above"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# FIELD HANDLING
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
field_handling:
  spec_id:
    derive_from: "spec_folder path using pattern specs/{NNN} or specs/{NNN-name}"
    fallback: "Extract numeric portion or use timestamp if extraction fails"

  defaults:
    git_branch_empty: "Auto-create feature-{NNN} from highest +001"
    spec_folder_empty: "Auto-create specs/{NNN} from highest +001"
    environment_empty: "Skip browser testing steps"
    scope_empty: "Use scope_policy.default"
    target_document_empty: "Use current directory or infer from [REQUEST]"
    context_empty: "Infer from file content and structure"
    issues_empty: "Identify during analysis"
    request_empty: "Use default from request_handling"

  scope_policy:
    default: "**/*.md"
    rule: "Process all .md files in target document when folder provided, else process single file from [TARGET_DOCUMENT]"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# DOCUMENT TYPE DETECTION (from create-documentation skill)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document_type_detection:
  # Detect document type FIRST to apply correct enforcement level
  types:
    README:
      enforcement: flexible
      frontmatter: none
      c7score_target: 85+
      structure_target: 95+
    SKILL:
      enforcement: strict
      frontmatter: required
      c7score_target: 85+
      structure_target: 100
      required_sections:
        - WHEN TO USE
        - HOW IT WORKS
        - RULES
    Knowledge:
      enforcement: moderate
      frontmatter: forbidden
      c7score_target: 80+
      structure_target: 100
    Command:
      enforcement: strict
      frontmatter: required
      c7score_target: 75+
      structure_target: 100
    Spec:
      enforcement: loose
      frontmatter: optional
      c7score_target: N/A
      structure_target: 90+
    Generic:
      enforcement: flexible
      frontmatter: optional
      c7score_target: N/A
      structure_target: N/A

  detection_rules:
    - filename_is_SKILL.md: SKILL
    - filename_is_README.md: README
    - path_contains_knowledge: Knowledge
    - path_contains_commands: Command
    - path_contains_specs: Spec
    - fallback: Generic

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# THREE-PHASE PIPELINE (from create-documentation skill)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
three_phase_pipeline:
  phase_1_enforcement:
    purpose: Structure validation and auto-fixes
    actions:
      - detect_document_type
      - validate_filename_conventions
      - check_frontmatter_requirements
      - verify_heading_hierarchy
      - check_section_order
      - auto_fix_safe_violations
    blocks_on:
      - missing_required_frontmatter
      - wrong_section_order
      - invalid_structure

  phase_2_optimization:
    purpose: Content enhancement for AI-friendliness
    actions:
      - apply_16_transformation_patterns
      - convert_to_question_answering_format
      - combine_import_with_usage_examples
      - ensure_complete_workflow_examples
    target: c7score 85+
    reference: "See .claude/skills/create-documentation/references/optimization.md for 16 transformation patterns"

  phase_3_validation:
    purpose: Quality scoring and gates
    actions:
      - calculate_triple_dimension_scores
      - evaluate_quality_gates
      - generate_improvement_recommendations

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# TRIPLE DIMENSION SCORING (from create-documentation skill)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
scoring:
  structure:
    weight: 40%
    checks:
      - yaml_frontmatter_valid
      - single_h1_no_duplicates
      - proper_heading_hierarchy
      - required_sections_present
      - section_separators_correct
      - code_blocks_fenced
      - no_unclosed_elements
      - emoji_usage_correct
    target_by_type:
      SKILL: 100
      Knowledge: 100
      README: 95+
      Command: 100
      Spec: 90+

  c7score:
    weight: 40%
    components:
      question_snippet_matching: 80 points
      llm_evaluation: 10 points
      formatting: 5 points
      metadata_removal: 2.5 points
      initialization: 2.5 points
    interpretation:
      90-100: excellent_comprehensive_coverage
      80-89: good_minor_gaps
      70-79: acceptable_needs_examples
      60-69: fair_significant_gaps
      below_60: poor_major_restructuring

  style:
    weight: 20%
    checks:
      - frontmatter_format_matches_guide
      - h2_numbered_headings_caps_emoji
      - h3_semantic_emojis_only_in_rules
      - code_examples_include_comments
      - bullet_lists_under_7_items
      - consistent_terminology
      - active_voice_preferred
    target: 90+

  overall:
    formula: "(Structure Ã— 0.40) + (C7Score Ã— 0.40) + (Style Ã— 0.20)"
    quality_gates:
      excellent: 90-100  # production ready
      good: 80-89       # shareable
      acceptable: 70-79 # functional
      needs_work: below_70

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# EMOJI USAGE RULES (from create-documentation skill)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
emoji_rules:
  H1:
    rule: NEVER
    example: "# Documentation Specialist"
  H2:
    rule: ALWAYS_numbered_with_emoji
    example: "## 1. ğŸ¯ CAPABILITIES"
  H3:
    rule: SEMANTIC_ONLY_in_RULES
    allowed_emojis: [âœ…, âŒ, âš ï¸]
    example: "### âœ… ALWAYS"
  H4_plus:
    rule: NEVER
    example: "#### Success Metrics"

optimization_philosophy:
  principle: "Structure first, then content, then quality"
  approach: "Three-phase pipeline: Enforcement â†’ Optimization â†’ Validation"
  mandate: "Eliminate ambiguity, reduce redundancy, maintain completeness"

scope:
  applies_to: entire_documentation_files_specified_by_arg
  targets:
    - instructions
    - accompanying_examples
    - redundant_content

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# SKILL REFERENCES (load for detailed patterns)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
skill_references:
  core_standards: ".claude/skills/create-documentation/references/core_standards.md"
  optimization_patterns: ".claude/skills/create-documentation/references/optimization.md"
  validation_details: ".claude/skills/create-documentation/references/validation.md"
  quick_reference: ".claude/skills/create-documentation/references/quick_reference.md"


# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# WORKFLOW
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
workflow:
  step_1_initialization:
    input_source: USER_INPUTS_SECTION_ABOVE
    git_branch: "[GIT_BRANCH] â†’ use or create if empty"
    spec_folder: "[SPEC_FOLDER] â†’ auto-create if empty"
    target_document: "[TARGET_DOCUMENT] â†’ document or folder to optimize"
    context: "[CONTEXT] â†’ infer if empty"
    issues: "[ISSUES] â†’ identify during analysis"
    request: "Use [REQUEST] if provided, else use default from request_handling"
    action: Load documentation files and prepare for optimization

    file_discovery:
      when_target_is_folder:
        - Load all .md files from [TARGET_DOCUMENT]
        - Include subdirectories if present
        - Prioritize spec.md, plan.md, README.md
      when_target_is_file:
        - Load single file from [TARGET_DOCUMENT]
        - Process for optimization

    initial_assessment:
      - Document count and types
      - Current complexity level
      - Obvious optimization opportunities
      - Estimated optimization scope

    deep_analysis:
      focus: comprehensive_document_assessment
      approach: systematic_evaluation
      outputs:
        - file_inventory
        - complexity_metrics
        - optimization_opportunities
        - scope_boundaries
        - processing_strategy

    outputs:
      - file_list
      - initial_assessment_summary
      - optimization_plan

  step_2_read_documents:
    action: Read all target documentation files
    context_integration: "Consider [CONTEXT] throughout analysis"
    input: file_list_from_step_1
    deep_analysis:
      focus: document_content_loading
      approach: systematic_file_processing
      outputs:
        - document_contents
        - document_metadata
        - initial_structure_map
        - content_relationships
    validation: documents_loaded_successfully

  step_3_analyze_sections:
    action: Analyze each document section and apply analysis methodology
    request_focus: "Prioritize areas mentioned in [REQUEST]"
    issues_awareness: "Pay special attention to [ISSUES] areas"
    analysis_steps:
      step_2a_evaluate_for_vagueness:
        question: Is the instruction clear without the examples?
        checks:
          - cover_examples_and_read_only_instruction_text
          - determine_if_executable_without_examples
          - detect_subjective_terms_without_definitions
          - verify_presence_of_measurable_criteria_or_explicit_steps
        decision_tree:
          condition: can_instruction_be_followed_without_examples
          yes: instruction_is_clear â†’ proceed_to_step_2
          no: instruction_is_vague â†’ proceed_to_step_3

      step_2b_if_clear_examples_not_needed:
        precondition: Instruction is unambiguous without examples
        execution_test: If the example is removed, can the agent still execute correctly?
        keep_remove_rules:
          KEEP_WHEN:
            - example_defines_ambiguous_term
            - defines_what_correct_looks_like
            - shows_exact_commands_with_success_criteria
            - sequential_workflows_where_order_matters
            - resolves_ambiguity_in_instruction_wording
            - data_structures_formats
          REMOVE_WHEN:
            - explains_why_rationale_only
            - merely_restates_already_clear_instruction

      step_2c_if_vague_examples_needed:
        rules:
          - do_not_remove_examples_yet_strengthen_instruction_first
        identify_vagueness_sources:
          - subjective_terms_without_definition
          - missing_criteria_or_measurements
          - unclear_boundaries_or_edge_cases
          - narrative_description_instead_of_explicit_steps
        strengthen_instruction:
          - replace_subjective_terms_with_explicit_criteria
          - convert_narrative_to_numbered_steps
          - add_measurable_thresholds_or_boundaries
          - define_success_criteria
        retention: keep_all_examples_until_instruction_is_strengthened
        next_pass: re_evaluate_examples_after_strengthening
    deep_analysis:
      focus: vagueness_and_clarity_evaluation
      approach: systematic_section_analysis
      outputs:
        - vagueness_inventory
        - clarity_assessment
        - example_necessity_map
        - strengthening_opportunities
        - optimization_candidates
    validation: analysis_complete

  step_4_optimize:
    action: Apply optimizations directly
    tasks:
      - strengthen_vague_instructions
      - remove_redundant_content
      - apply_conciseness_strategies
    deep_analysis:
      focus: optimization_implementation
      approach: systematic_improvement
      outputs:
        - optimized_content
        - strengthened_instructions
        - removed_redundancies
        - preserved_essential_content
        - optimization_metrics
    validation: optimizations_applied

  step_5_report_changes:
    action: Generate comprehensive change summary
    format: optimization_summary_template
    deep_analysis:
      focus: change_documentation
      approach: comprehensive_reporting
      outputs:
        - change_report
        - metrics_summary
        - improvement_highlights
        - before_after_comparison
        - optimization_effectiveness
    validation: report_generated

  step_6_completion:
    summary_document:
      location: "[SPEC_FOLDER]/optimization-summary.md"
      required_sections:
        - files_optimized
        - changes_made
        - metrics
          - lines_removed
          - sections_strengthened
          - vagueness_eliminated
          - redundancy_removed
        - quality_improvements
        - idempotent_status
    deep_analysis:
      focus: completion_verification
      approach: comprehensive_validation
      outputs:
        - final_summary_document
        - quality_verification_results
        - idempotency_confirmation
        - optimization_completion_status
    final_checklist:
      - all_files_optimized: true
      - meaning_preserved: true
      - clarity_maintained_or_improved: true
      - redundancy_eliminated: true
      - summary_created: true
    validation: workflow_completed

  step_7_save_context:
    action: Save optimization conversation context
    invocation: Skill(skill: "save-context")
    description: |
      Preserve comprehensive optimization conversation including:
      - Document analysis and vagueness identification
      - Optimization decisions and rationale
      - Changes made and quality improvements
      - Metrics and validation results
    outputs:
      - context_file: "[SPEC_FOLDER]/memory/[DD-MM-YY_HH-MM]__optimization_session.md"
      - workflow_flowchart: auto_generated
      - optimization_decisions: documented
    validation: context_saved_successfully
    note: |
      Context saved to memory/ subfolder within spec folder.
      Captures full optimization journey including analysis and improvements.

  step_8_branch_integration:
    name: Branch Integration
    action: Integrate optimized documentation to main branch
    integration_policy:
      merge_strategy: rebase_then_fast_forward
      safety_checks:
        - clean working tree
        - validations/tests/pass checks are green (as applicable for the workflow)
        - no unresolved blockers
      conflict_policy:
        on_rebase_conflict: pause and ask for guidance
        fallback_to_pr: offer to open a PR if user prefers manual resolution
      steps:
        - fetch origin
        - update main (pull --ff-only)
        - rebase feature branch onto main
        - fast-forward merge into main
        - push origin main
        - after successful integration, offer to delete the feature branch locally and on origin (explicit confirmation required)
      tagging: optional; only on user request
    deep_analysis:
      focus: integration_execution
      approach: safe_merge_strategy
      outputs:
        - integration_status
        - branch_state
        - conflict_resolution_log
        - final_branch_status
    validation: integration_complete

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# WORKFLOW TERMINATION
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
termination:
  after_step: 8
  message: "Documentation optimization completed successfully. Workflow terminated after step 8 (branch integration)."
  next_steps:
    - Review [SPEC_FOLDER]/optimization-summary.md for details
    - Verify optimized documents maintain clarity and meaning
    - Use optimized documents for improved workflow execution
  
  spec_folder_output:
    - "[SPEC_FOLDER]/optimization-summary.md - Complete optimization report"
    - "[SPEC_FOLDER]/memory/[timestamp]__optimization_session.md - Session context"


# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# DECISION TREES
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
decision_trees:
  instruction_clarity:
    description: Determines if examples are required
    nodes:
      - id: root
        condition: can_instruction_be_followed_without_examples
        true_next: clear
        false_next: vague
      - id: clear
        action: evaluate_examples_for_operational_value
        outputs:
          - keep_if_defines_correctness_or_resolves_ambiguity
          - remove_if_redundant_or_rationale_only
      - id: vague
        action: strengthen_instruction_then_keep_examples
        notes: Re-assess examples in next pass after strengthening

  execution_test:
    description: Governs removal decisions for any content
    steps:
      - question: Can the instruction be executed correctly without this content?
        if_no: keep
      - question: Does the content only explain why (rationale/educational)?
        if_yes: remove
      - question: Does the content define what "correct" looks like (success criteria)?
        if_yes: keep
      - question: Does the content extract a general decision rule from a specific example?
        if_yes: keep
      - otherwise: may_remove_if_redundant

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# OPTIMIZATION STRATEGIES
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
strategies:
  conciseness_techniques:
    - eliminate_redundancy
    - tighten_language
    - use_structure_over_prose
    - preserve_essential_elements

  language_tightening:
    replacements:
      - from: "you MUST execute"
        to: "execute"
      - from: "in order to"
        to: "to"
    remove_fillers:
      - clearly
      - obviously
      - simply

  preserve_always:
    - scannability_with_vertical_lists
    - pattern_recognition_via_checkmarks_or_bullets
    - explicit_quantifiers_all_at_least_one_never
    - measurable_thresholds_counts_paths_exact_strings
    - prevention_patterns_prohibited_vs_required
    - error_condition_definitions

  anti_patterns_avoid:
    - convert_vertical_list_to_slash_separated
    - compress_checklists_into_prose
    - remove_navigation_headers
    - merge_distinct_concepts_into_run_on_sentence
    - replace_goals_with_priority_reference_not_equivalent
    - remove_quick_reference_lists_because_detailed_exists

user_workflow:
  usage_example: |
    # First invocation: Strengthens and removes redundancy
    /optimize-doc docs/some-file.md

    # Optional second invocation for further optimization
    /optimize-doc docs/some-file.md

    # Subsequent invocations: No changes if already optimized
    /optimize-doc docs/some-file.md

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# QUALITY STANDARDS
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
quality_standards:
  must_satisfy_all:
    - meaning_preserved
    - executability_preserved
    - success_criteria_intact
    - ambiguity_resolved
    - conciseness_increased

  verification_test:
    step_1:
      question: Can instruction be executed correctly without removed content?
      if_no: reject_optimization
    step_2:
      question: Does removed content only explain why (rationale/educational)?
      if_yes: accept_removal
    step_3:
      question: Does removed content extract a general decision rule?
      if_yes: reject_removal_keep_it
    final_rule:
      - if_step_1_no_or_step_3_yes â†’ reject
      - if_step_2_yes_and_others_no â†’ accept

  hierarchy:
    priority_order:
      - correctness
      - efficiency
      - conciseness
    rule: Never sacrifice correctness for conciseness; prefer conciseness only when correctness and clarity are preserved

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# RULES
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
rules:
  ALWAYS:
    - evaluate_instruction_clarity_before_removing_examples
    - strengthen_vague_instructions_with_explicit_criteria
    - preserve_execution_critical_content
    - verify_semantic_equivalence_after_changes
    - apply_execution_test_to_all_removals
    - maintain_correctness_over_conciseness

  NEVER:
    - remove_content_that_defines_success_criteria
    - sacrifice_clarity_for_brevity
    - change_semantic_meaning
    - remove_pattern_extraction_rules
    - consolidate_mid_workflow_content_with_references
    - replace_quick_reference_lists_with_detailed_sections

  KEEP_EXAMPLES:
    - executable_commands
    - data_structures_and_schemas
    - boundary_demonstrations
    - concept_illustrations_for_vague_terms
    - templates
    - prevention_examples_wrong_vs_right
    - pattern_extraction_rules

  REMOVE_EXAMPLES:
    - redundant_clarification
    - obvious_applications_of_clear_rules
    - duplicate_templates
    - verbose_walkthroughs_when_numbered_steps_exist

  EXECUTION_CRITICAL_NEVER_CONDENSE:
    concrete_examples_defining_correct:
      keep_if:
        - example_disambiguates_instruction_terms
        - provides_specific_paths_lines_outputs
      example_pair:
        language: bash
        wrong: |
          # WRONG: marking complete in todo.md
          vim todo.md  # Changed - [ ] to - [x]
          git commit -m "..." todo.md  # Result: Still in todo.md
        correct: |
          # CORRECT: delete entry in todo.md, add to changelog.md
          vim todo.md  # DELETE entire task entry
          vim changelog.md  # ADD under today's date section
      remove_if: instruction_already_explicitly_states_remove_entire_entry

    sequential_steps_for_state_machines:
      keep_when: order_is_mandatory_for_correctness
      example_numbered_sequence:
        - complete_synthesis_phase
        - present_plan_to_user
        - update_lock: jq '.state = "SYNTHESIS_AWAITING_APPROVAL"'
        - stop_and_wait_for_user
        - on_approval_update_lock_to_context_and_proceed
      remove_numbering_if: steps_are_independent_and_order_does_not_matter

    inline_comments_specifying_what_to_verify:
      keep_when: comment_specifies_success_criteria_not_stated_elsewhere
      example: |
        # Before: git rev-list --count HEAD
        # After: git rev-list --count HEAD
        # Compare counts - should match unless you explicitly intended to drop commits
      remove_when: comment_explains_why_only

    disambiguation_examples:
      keep_when: examples_resolve_potential_misinterpretation
      remove_when: examples_restate_clear_instructions

    pattern_extraction_rules:
      keep_when: text_extracts_general_rule_from_specific_example
      remove_when: generic_commentary_without_actionable_rule
      tests:
        - if_removed_would_agent_lose_ability_to_apply_rule_to_new_cases â†’ keep

  reference_based_condensing_rules:
    NEVER_REPLACE_WITH_REFERENCES:
      - content_within_sequential_workflows
      - quick_reference_lists_in_methodology_sections
      - success_criteria_at_decision_points
    OK_TO_REPLACE_WITH_REFERENCES:
      - explanatory_content_repeated_in_multiple_places
      - boundary_content_at_document_edges_intro_conclusion
      - cross_references_for_related_but_distinct_concepts
    semantic_equivalence_test:
      same_information: referenced_section_contains_exact_same_information
      same_context: referenced_section_serves_same_purpose
      same_level_of_detail: no_precision_lost
    duplication_taxonomy:
      type_1_keep_both: quick_reference_plus_detailed
      type_2_consolidate: exact_duplication
      type_3_context_dependent: pedagogical_repetition
    pre_consolidation_verification:
      checks:
        - content_is_byte_for_byte_or_semantically_equivalent
        - replacement_does_not_interrupt_workflow
        - referenced_section_has_same_level_of_detail
        - quick_reference_value_not_removed
        - execution_test_passes_with_reference

  decision_rule_execution_test:
    questions:
      - can_execute_without_content â†’ if_no_keep
      - content_explains_why_only â†’ if_yes_remove
      - content_defines_success_criteria â†’ if_yes_keep
      - content_extracts_general_decision_rule â†’ if_yes_keep
      - else: may_remove_if_redundant
    examples:
      remove_this_rationale: |
        RATIONALE: Git history rewriting can silently drop commits or changes...
      keep_this_success_criteria: |
        ARCHIVAL SUCCESS CRITERIA:
        - git diff todo.md shows ONLY deletions
        - git diff changelog.md shows ONLY additions under today's date
        - Both files in SAME commit
        - grep task-name todo.md returns no matches
      keep_delete_disambiguation: |
        # WRONG: Changing checkbox state in todo.md
        vim todo.md  # Changed - [ ] to - [x]
        # CORRECT: Deleting the entry
        vim todo.md  # DELETE entire task entry